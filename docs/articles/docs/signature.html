<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Signature Extension • hypeR.next</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Signature Extension">
<meta property="og:description" content="hypeR.next">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">hypeR.next</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/docs/data.html">Data Example</a>
    </li>
    <li>
      <a href="../../articles/docs/characterization.html">Network Characterization</a>
    </li>
    <li>
      <a href="../../articles/docs/signature.html">Signature Extension</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/montilab/hypeR-next">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="signature_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Signature Extension</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/montilab/hypeR-next/blob/master/vignettes/docs/signature.Rmd"><code>vignettes/docs/signature.Rmd</code></a></small>
      <div class="hidden name"><code>signature.Rmd</code></div>

    </div>

    
    
<div id="extending-a-signature-in-a-network-context" class="section level3">
<h3 class="hasAnchor">
<a href="#extending-a-signature-in-a-network-context" class="anchor"></a>Extending a signature in a network context</h3>
<p>Using similar methods, we can take a pre-defined signature, and contextualize it based on the existing network structure. We can see which signature genes are present in the network, which signature genes are most central, or which non-signature genes are within close proximity.</p>
<p>Let’s pretend our signature happened to be a bunch of genes from one of our simulated communities…</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">signature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATP2B1"</span>, <span class="st">"KLF6"</span>, <span class="st">"IL1A"</span>, <span class="st">"CD69"</span>, <span class="st">"GCH1"</span>, <span class="st">"MXD1"</span>, <span class="st">"F3"</span><span class="op">)</span></code></pre></div>
<p>Here you are passing in node symbols. The symbols are mapped to the unique node identifiers which is what are used for network propagation. That means if you have unique nodes multi-mapping to non-unique gene symbols, you’ll will have multiple propagation values for duplicated symbols.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ig.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/extend_signature.html">extend_signature</a></span><span class="op">(</span><span class="va">ig</span>, <span class="va">signature</span>, restart<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">as_data_frame</a></span><span class="op">(</span><span class="va">ig.s</span>, what<span class="op">=</span><span class="st">"vertices"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>       community   color symbol   name            p  pcolor
GMPS           8 #3E134F   GMPS   GMPS 0.000000e+00 #FFFFFE
PDLIM1        15 #9A9800 PDLIM1 PDLIM1 9.237848e-06 #FFFFFE
JUNB          15 #9A9800   JUNB   JUNB 4.535853e-06 #FFFFFE
RER1          17 #50E2BB   RER1   RER1 7.462290e-06 #FFFFFE
ICAM1         14 #A96C00  ICAM1  ICAM1 2.645026e-05 #FFFFFE
NPFFR2        14 #A96C00 NPFFR2 NPFFR2 1.778050e-06 #FFFFFE</code></pre>
<p>Here we can visualize the propagation throughout the network from the signature.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ig.s</span>,
     vertex.size<span class="op">=</span><span class="fl">4</span>,
     vertex.color<span class="op">=</span><span class="fu">V</span><span class="op">(</span><span class="va">ig.s</span><span class="op">)</span><span class="op">$</span><span class="va">pcolor</span>,
     vertex.label<span class="op">=</span><span class="cn">NA</span>,
     edge.width<span class="op">=</span><span class="fl">1</span>,
     layout<span class="op">=</span><span class="va">layout</span><span class="op">)</span></code></pre></div>
<p><img src="signature_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
<p>Here we return the new signature based on the ranked propagation from the original signature.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">ig.s</span> <span class="op">%&gt;%</span>
      <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">as_data_frame</a></span><span class="op">(</span>what<span class="op">=</span><span class="st">"vertices"</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>np<span class="op">=</span><span class="fu"><a href="../../reference/normalize_range.html">normalize_range</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">symbol</span>, <span class="va">p</span>, <span class="va">np</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>original_signature <span class="op">=</span> <span class="va">symbol</span> <span class="op">%in%</span> <span class="va">signature</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>       symbol          p        np original_signature
KLF6     KLF6 0.09076717 1.0000000               TRUE
MXD1     MXD1 0.08970336 0.9882798               TRUE
F3         F3 0.08768029 0.9659912               TRUE
GCH1     GCH1 0.08309481 0.9154722               TRUE
CD69     CD69 0.08086103 0.8908621               TRUE
ATP2B1 ATP2B1 0.07985923 0.8798251               TRUE
IL1A     IL1A 0.07906760 0.8711036               TRUE
CCL20   CCL20 0.03224921 0.3552960              FALSE
YRDC     YRDC 0.03119150 0.3436430              FALSE
IL6       IL6 0.02915137 0.3211665              FALSE</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">extended_signature</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">symbol</span>, <span class="va">np</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">deframe</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">extended_signature</span>, <span class="fl">15</span><span class="op">)</span></code></pre></div>
<pre><code>     KLF6      MXD1        F3      GCH1      CD69    ATP2B1      IL1A     CCL20 
1.0000000 0.9882798 0.9659912 0.9154722 0.8908621 0.8798251 0.8711036 0.3552960 
     YRDC       IL6      RELA     SPSB1   TNFAIP3   SLC16A6     CXCL6 
0.3436430 0.3211665 0.3146207 0.2589525 0.2437994 0.2089514 0.2035255 </code></pre>
<p>The original signature will likely have the most propagation values (because that is the seed), but we can find other genes with high propagation values close to the signature within the network.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">original_signature</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">symbol</span>, levels<span class="op">=</span><span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">name</span>, y<span class="op">=</span><span class="va">np</span>, fill<span class="op">=</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span>
    <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Extended Symbols"</span>, y<span class="op">=</span><span class="st">"Normalized Propogation"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span>, vjust<span class="op">=</span><span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="signature_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ig.s</span>,
     vertex.size<span class="op">=</span><span class="fl">3</span>,
     vertex.color<span class="op">=</span><span class="fu">V</span><span class="op">(</span><span class="va">ig.s</span><span class="op">)</span><span class="op">$</span><span class="va">pcolor</span>,
     vertex.frame.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html">adjustcolor</a></span><span class="op">(</span><span class="st">"#000000"</span>, alpha.f<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,
     vertex.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">ig.s</span><span class="op">)</span><span class="op">$</span><span class="va">p</span> <span class="op">&gt;</span> <span class="fl">0.01</span>, <span class="fu">V</span><span class="op">(</span><span class="va">ig.s</span><span class="op">)</span><span class="op">$</span><span class="va">symbol</span>, <span class="cn">NA</span><span class="op">)</span>,
     vertex.label.family<span class="op">=</span><span class="st">"Helvetica"</span>,
     vertex.label.color<span class="op">=</span><span class="st">"black"</span>,
     vertex.label.font<span class="op">=</span><span class="fl">2</span>,
     vertex.label.cex<span class="op">=</span><span class="fl">0.8</span>,
     edge.width<span class="op">=</span><span class="fl">1</span>,
     layout<span class="op">=</span><span class="va">layout</span><span class="op">)</span></code></pre></div>
<p><img src="signature_files/figure-html/unnamed-chunk-9-1.png" width="1152"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/anfederico">Anthony Federico</a>, <a href="https://github.com/tetomonti">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
